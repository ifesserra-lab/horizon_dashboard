---
import type { Project } from '../types/projects';

interface Props {
	project: Project;
}

const { project } = Astro.props;

const formatDate = (dateStr: string) => {
	if (!dateStr) return 'N/A';
	const date = new Date(dateStr);
	return date.toLocaleDateString('pt-BR', {
		day: '2-digit',
		month: '2-digit',
		year: 'numeric'
	});
};

const statusStyles = {
	active: 'bg-emerald-500/10 text-emerald-500 border-emerald-500/20',
	concluded: 'bg-slate-500/10 text-slate-500 border-slate-500/20',
};

const currentStatusStyle = statusStyles[project.status as keyof typeof statusStyles] || 'bg-premium-accent/10 text-premium-accent border-premium-accent/20';
---

<article 
	class="project-card glass-card p-6 hover:border-premium-accent/40 hover:bg-premium-accent/[0.02] transition-all flex flex-col h-full"
	data-name={project.name.toLowerCase()}
	data-status={project.status.toLowerCase()}
>
	<div class="flex items-start justify-between mb-4">
		<div aria-hidden="true" class="w-10 h-10 rounded-lg bg-gradient-to-br from-premium-accent/10 to-premium-purple/10 border border-border-main flex items-center justify-center text-premium-accent">
			<svg xmlns="http://www.w3.org/2000/svg" class="w-5 h-5" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M4 19.5A2.5 2.5 0 0 1 6.5 17H20"/><path d="M6.5 2H20v20H6.5A2.5 2.5 0 0 1 4 19.5v-15A2.5 2.5 0 0 1 6.5 2z"/></svg>
		</div>
		<span class={`px-3 py-1 rounded-full text-[10px] font-bold uppercase tracking-wider border ${currentStatusStyle}`}>
			{project.status === 'active' ? 'Ativo' : project.status === 'concluded' ? 'Concluído' : project.status}
		</span>
	</div>
	
	<h3 class="text-base font-bold text-text-main mb-3 leading-tight group-hover:text-premium-accent transition-colors line-clamp-3 min-h-[3rem]">
		{project.name}
	</h3>

	<div class="space-y-3 mb-6 flex-1">
		<div class="flex items-center gap-2 text-xs text-text-secondary">
			<svg xmlns="http://www.w3.org/2000/svg" class="w-4 h-4 opacity-70" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="3" y="4" width="18" height="18" rx="2" ry="2"/><line x1="16" y1="2" x2="16" y2="6"/><line x1="8" y1="2" x2="8" y2="6"/><line x1="3" y1="10" x2="21" y2="10"/></svg>
			<span>{formatDate(project.start_date)} — {formatDate(project.end_date)}</span>
		</div>
		{project.description && (
			<p class="text-sm text-text-secondary line-clamp-3">
				{project.description}
			</p>
		)}
		{!project.description && (
			<p class="text-sm text-text-secondary italic opacity-70">
				Sem descrição disponível.
			</p>
		)}
	</div>

	<div class="pt-4 border-t border-border-main flex justify-end items-center mt-auto">
		<span class="text-[10px] font-medium text-text-secondary uppercase">ID: {project.id}</span>
	</div>
</article>
